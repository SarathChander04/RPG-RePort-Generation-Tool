{% extends "base.html" %}
{% block title %}Edit Vulnerability{% endblock %}
{% block content %}
<h2>Edit Vulnerability â€” {{ vuln.name }}</h2>
<form method="post">
  <div class="form-group">
    <label for="name">Name:</label>
    <input type="text" id="name" name="name" value="{{ vuln.name }}" required>
  </div>
  <div class="form-group">
    <label for="vapt_type">VAPT Type:</label>
    <select id="vapt_type" name="vapt_type" required>
      {% for t in vapt_types %}
        <option value="{{ t }}" {% if vuln.vapt_type==t %}selected{% endif %}>{{ t }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="form-group">
    <label for="severity">Severity:</label>
    <select id="severity" name="severity" required>
      {% for s in severity_types %}
        <option value="{{ s }}" {% if vuln.severity==s %}selected{% endif %}>{{ s }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="form-group">
    <label for="cvss_score">CVSS Score:</label>
    <input type="number" step="0.1" id="cvss_score" name="cvss_score" value="{{ vuln.cvss_score or '' }}">
  </div>
  <div class="form-group">
    <label for="description">Description:</label>
    <textarea id="description" name="description">{{ vuln.description or '' }}</textarea>
  </div>
  <div class="form-group">
    <label for="impact">Impact:</label>
    <textarea id="impact" name="impact">{{ vuln.impact or '' }}</textarea>
  </div>
  <div class="form-group">
    <label for="remediation">Remediation:</label>
    <textarea id="remediation" name="remediation">{{ vuln.remediation or '' }}</textarea>
  </div>
  <div class="form-group">
    <label for="references_text">References:</label>
    <textarea id="references_text" name="references_text">{{ vuln.references_text or '' }}</textarea>
  </div>
  <button type="submit" class="btn btn-primary">Update</button>
</form>
{% endblock %}